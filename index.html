<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <!-- DNS prefetch for API requests -->
    <link rel="dns-prefetch" href="//raw.githubusercontent.com" />
    
    <!-- Inline critical CSS for instant first paint -->
    <style>
      /* Critical CSS - prevents FOUC */
      :root{--background:222.2 84% 4.9%;--foreground:210 40% 98%;--primary:217.2 91.2% 59.8%}
      *{margin:0;padding:0;box-sizing:border-box}
      body{background:hsl(var(--background));color:hsl(var(--foreground));font-family:system-ui,-apple-system,BlinkMacSystemFont,'Segoe UI',Roboto,Oxygen,Ubuntu,Cantarell,sans-serif}
      #root{min-height:100vh}
      .initial-loader{display:flex;justify-content:center;align-items:center;min-height:100vh}
      .spinner{width:40px;height:40px;border:3px solid hsl(var(--foreground)/.2);border-top-color:hsl(var(--primary));border-radius:50%;animation:spin .8s linear infinite}
      @keyframes spin{to{transform:rotate(360deg)}}
    </style>

    <title>{{ user.username }} Sub Info</title>
  </head>
  <body>
    <div id="root"></div>
    
    <!-- Jinja2 embedded initial data - loads instantly without network request -->
    <script>
      try {
        window.__INITIAL_DATA__ = {
          user: {% if user %}{{ {
            'id': user.id,
            'username': user.username,
            'status': user.status.name if user.status else 'active',
            'used_traffic': user.used_traffic,
            'lifetime_used_traffic': user.lifetime_used_traffic,
            'data_limit': user.data_limit,
            'data_limit_reset_strategy': user.data_limit_reset_strategy.name if user.data_limit_reset_strategy else 'no_reset',
            'expire': user.expire.timestamp() if user.expire else None,
            'expire_date': user.expire.timestamp() if user.expire else None,
            'on_hold_expire_duration': user.on_hold_expire_duration,
            'on_hold_timeout': user.on_hold_timeout.timestamp() if user.on_hold_timeout else None,
            'created_at': user.created_at.timestamp() if user.created_at else None,
            'online_at': user.online_at.timestamp() if user.online_at else None,
            'is_active': user.status.name == 'active' if user.status else True,
            'enabled': user.status.name != 'disabled' if user.status else True,
            'expired': user.status.name == 'expired' if user.status else False,
            'data_limit_reached': user.status.name == 'limited' if user.status else False,
            'subscription_url': user.subscription_url if user.subscription_url else None
          } | tojson | safe }}{% else %}null{% endif %},
          links: {{ links | tojson | safe if links else '[]' }}
        };
      } catch (e) {
        console.warn('Failed to parse initial data:', e);
        window.__INITIAL_DATA__ = null;
      }
    </script>
    
    <script type="module" src="/src/main.jsx"></script>
  </body>
</html>
